<!-- Sidebar -->
<aside class="sidebar" id="sidebar" role="navigation" aria-label="Main navigation">
  <div class="sidebar-header">
    <a href="/dashboard" class="sidebar-brand" aria-label="IskolarPath Home">
      <img src="/images/icon.svg" alt="" class="brand-icon" aria-hidden="true">
      <span class="brand-text">IskolarPath</span>
    </a>
  </div>

  <a href="/admin/profile" class="sidebar-user" style="text-decoration: none; color: inherit;" aria-label="View your profile">
    <div class="user-avatar" aria-hidden="true">
      <% if (typeof profilePicture !== 'undefined' && profilePicture) { %>
        <img src="<%= profilePicture %>" alt="" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">
      <% } else { %>
        <span><%= typeof fullName !== 'undefined' && fullName ? fullName.charAt(0).toUpperCase() : 'A' %></span>
      <% } %>
    </div>
    <div class="user-info">
      <div class="user-name"><%= typeof fullName !== 'undefined' && fullName ? fullName : 'Administrator' %></div>
      <div class="user-email"><%= email %></div>
    </div>
  </a>

  <nav class="sidebar-nav" aria-label="Admin menu">
    <a href="/dashboard" class="nav-link" data-tooltip="Dashboard">
      <span class="nav-text">Dashboard</span>
    </a>
    <a href="/admin/pending-scholarships" class="nav-link" data-tooltip="Pending Review">
      <span class="nav-text">Pending Review</span>
      <span class="nav-badge pending-count" id="pendingCount" style="display: none;" aria-label="pending items"></span>
    </a>
    <a href="/admin/approved-scholarships" class="nav-link" data-tooltip="Manage Approved">
      <span class="nav-text">Approved Offers</span>
    </a>
    <a href="/admin/applications" class="nav-link" data-tooltip="Review Applications">
      <span class="nav-text">Review Applications</span>
    </a>
    <a href="/admin/users" class="nav-link" data-tooltip="Manage Users">
      <span class="nav-text">Manage Users</span>
    </a>
    <a href="/admin/reports" class="nav-link" data-tooltip="Reports">
      <span class="nav-text">Reports</span>
    </a>
    <a href="/admin/notifications" class="nav-link" data-tooltip="Notifications">
      <span class="nav-text">Notifications</span>
      <span class="nav-badge notification-count" id="notificationCount" style="display: none;" aria-label="unread notifications"></span>
    </a>
  </nav>
  <style>
    .nav-badge {
      background: #ef4444;
      color: white;
      font-size: 0.7rem;
      padding: 0.15rem 0.4rem;
      border-radius: 999px;
      margin-left: 0.5rem;
      font-weight: 600;
    }
  </style>
  <script>
    // Fetch notification and pending counts
    document.addEventListener('DOMContentLoaded', function() {
      fetch('/admin/api/counts')
        .then(res => res.json())
        .then(data => {
          if (data.pendingScholarships > 0) {
            const pendingEl = document.getElementById('pendingCount');
            pendingEl.textContent = data.pendingScholarships;
            pendingEl.style.display = 'inline';
          }
          if (data.unreadNotifications > 0) {
            const notifEl = document.getElementById('notificationCount');
            notifEl.textContent = data.unreadNotifications;
            notifEl.style.display = 'inline';
          }
        })
        .catch(err => console.log('Could not load counts'));
    });
  </script>

  <div class="sidebar-footer">
    <form action="/logout" method="POST" id="logoutForm">
      <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
      <button type="button" class="logout-btn" data-tooltip="Logout" onclick="showLogoutModal(event)" aria-label="Log out of your account">
        <span class="nav-text">Logout</span>
      </button>
    </form>
  </div>
</aside>

<!-- Sidebar Overlay -->
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<!-- Logout Modal Scripts -->
<link rel="stylesheet" href="/css/logout-modal.css">
<script src="/js/logout-modal.js"></script>
